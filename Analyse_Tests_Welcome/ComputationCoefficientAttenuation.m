%% Loading the skull data

% s1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\250kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_250kHz')
Isppa_Crane_1_250 = Isppa;
FWHM_Crane_1_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\300kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_300kHz')
Isppa_Crane_1_300 = Isppa;
FWHM_Crane_1_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\350kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_350kHz')
Isppa_Crane_1_350 = Isppa;
FWHM_Crane_1_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\400kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_400kHz')
Isppa_Crane_1_400 = Isppa;
FWHM_Crane_1_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\450kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_450kHz')
Isppa_Crane_1_450 = Isppa;
FWHM_Crane_1_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_1\500kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_1_500kHz')
Isppa_Crane_1_500 = Isppa;
FWHM_Crane_1_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s2%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\250kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_250kHz')
Isppa_Crane_2_250 = Isppa;
FWHM_Crane_2_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\300kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_300kHz')
Isppa_Crane_2_300 = Isppa;
FWHM_Crane_2_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\350kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_350kHz')
Isppa_Crane_2_350 = Isppa;
FWHM_Crane_2_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\400kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_400kHz')
Isppa_Crane_2_400 = Isppa;
FWHM_Crane_2_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\450kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_450kHz')
Isppa_Crane_2_450 = Isppa;
FWHM_Crane_2_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_2\500kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_2_500kHz')
Isppa_Crane_2_500 = Isppa;
FWHM_Crane_2_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s3%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\250kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_250kHz')
Isppa_Crane_3_250 = Isppa;
FWHM_Crane_3_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\300kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_300kHz')
Isppa_Crane_3_300 = Isppa;
FWHM_Crane_3_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\350kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_350kHz')
Isppa_Crane_3_350 = Isppa;
FWHM_Crane_3_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\400kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_400kHz')
Isppa_Crane_3_400 = Isppa;
FWHM_Crane_3_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\450kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_450kHz')
Isppa_Crane_3_450 = Isppa;
FWHM_Crane_3_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_3\500kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_3_500kHz')
Isppa_Crane_3_500 = Isppa;
FWHM_Crane_3_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s4%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\250kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_250kHz')
Isppa_Crane_4_250 = Isppa;
FWHM_Crane_4_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\300kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_300kHz')
Isppa_Crane_4_300 = Isppa;
FWHM_Crane_4_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\350kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_350kHz')
Isppa_Crane_4_350 = Isppa;
FWHM_Crane_4_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\400kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_400kHz')
Isppa_Crane_4_400 = Isppa;
FWHM_Crane_4_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\450kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_450kHz')
Isppa_Crane_4_450 = Isppa;
FWHM_Crane_4_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_4\500kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_4_500kHz')
Isppa_Crane_4_500 = Isppa;
FWHM_Crane_4_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s5%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\250kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_250kHz')
Isppa_Crane_5_250 = Isppa;
FWHM_Crane_5_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\300kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_300kHz')
Isppa_Crane_5_300 = Isppa;
FWHM_Crane_5_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\350kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_350kHz')
Isppa_Crane_5_350 = Isppa;
FWHM_Crane_5_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\400kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_400kHz')
Isppa_Crane_5_400 = Isppa;
FWHM_Crane_5_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\450kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_450kHz')
Isppa_Crane_5_450 = Isppa;
FWHM_Crane_5_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\AvecCrane\1Vpp_200Cycles_6Freq_Crane_5\500kHz\UltrasoundParameters_SessionAttenuation_AvecCrane_1Vpp_200Cycles_6Freq_Crane_5_500kHz')
Isppa_Crane_5_500 = Isppa;
FWHM_Crane_5_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%% Loading for without skull data

% s1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\250kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_250kHz')
Isppa_Sans_1_250 = Isppa;
FWHM_Sans_1_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\300kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_300kHz')
Isppa_Sans_1_300 = Isppa;
FWHM_Sans_1_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\350kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_350kHz')
Isppa_Sans_1_350 = Isppa;
FWHM_Sans_1_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\400kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_400kHz')
Isppa_Sans_1_400 = Isppa;
FWHM_Sans_1_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\450kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_450kHz')
Isppa_Sans_1_450 = Isppa;
FWHM_Sans_1_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_1\500kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_1_500kHz')
Isppa_Sans_1_500 = Isppa;
FWHM_Sans_1_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s2%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\250kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_250kHz')
Isppa_Sans_2_250 = Isppa;
FWHM_Sans_2_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\300kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_300kHz')
Isppa_Sans_2_300 = Isppa;
FWHM_Sans_2_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\350kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_350kHz')
Isppa_Sans_2_350 = Isppa;
FWHM_Sans_2_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\400kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_400kHz')
Isppa_Sans_2_400 = Isppa;
FWHM_Sans_2_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\450kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_450kHz')
Isppa_Sans_2_450 = Isppa;
FWHM_Sans_2_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_2\500kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_2_500kHz')
Isppa_Sans_2_500 = Isppa;
FWHM_Sans_2_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s3%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\250kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_250kHz')
Isppa_Sans_3_250 = Isppa;
FWHM_Sans_3_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\300kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_300kHz')
Isppa_Sans_3_300 = Isppa;
FWHM_Sans_3_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\350kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_350kHz')
Isppa_Sans_3_350 = Isppa;
FWHM_Sans_3_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\400kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_400kHz')
Isppa_Sans_3_400 = Isppa;
FWHM_Sans_3_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\450kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_450kHz')
Isppa_Sans_3_450 = Isppa;
FWHM_Sans_3_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_3\500kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_3_500kHz')
Isppa_Sans_3_500 = Isppa;
FWHM_Sans_3_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s4%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\250kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_250kHz')
Isppa_Sans_4_250 = Isppa;
FWHM_Sans_4_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\300kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_300kHz')
Isppa_Sans_4_300 = Isppa;
FWHM_Sans_4_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\350kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_350kHz')
Isppa_Sans_4_350 = Isppa;
FWHM_Sans_4_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\400kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_400kHz')
Isppa_Sans_4_400 = Isppa;
FWHM_Sans_4_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\450kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_450kHz')
Isppa_Sans_4_450 = Isppa;
FWHM_Sans_4_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_4\500kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_4_500kHz')
Isppa_Sans_4_500 = Isppa;
FWHM_Sans_4_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%s5%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\250kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_250kHz')
Isppa_Sans_5_250 = Isppa;
FWHM_Sans_5_250 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\300kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_300kHz')
Isppa_Sans_5_300 = Isppa;
FWHM_Sans_5_300 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\350kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_350kHz')
Isppa_Sans_5_350 = Isppa;
FWHM_Sans_5_350 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\400kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_400kHz')
Isppa_Sans_5_400 = Isppa;
FWHM_Sans_5_400 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\450kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_450kHz')
Isppa_Sans_5_450 = Isppa;
FWHM_Sans_5_450 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

load ('D:\data\jlambert\TFUS_Mesures_Welcome\SessionAttenuation\SansCrane\1Vpp_200Cycles_6Freq_Sans_5\500kHz\UltrasoundParameters_SessionAttenuation_SansCrane_1Vpp_200Cycles_6Freq_Sans_5_500kHz')
Isppa_Sans_5_500 = Isppa;
FWHM_Sans_5_500 = FWHM_Matrix;
clear Isppa FWHM_Matrix BurstHydrophone Pi MI TI Ispta TimeVector_BurstHydrophone

%% Computation of the attenuation coefficient
Coeff_Attenuation_s1_250kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_250.*Isppa_Sans_1_250))/mean(nonzeros(FWHM_Crane_1_250.*Isppa_Crane_1_250)));
Coeff_Attenuation_s1_300kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_300.*Isppa_Sans_1_300))/mean(nonzeros(FWHM_Crane_1_300.*Isppa_Crane_1_300)));
Coeff_Attenuation_s1_350kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_350.*Isppa_Sans_1_350))/mean(nonzeros(FWHM_Crane_1_350.*Isppa_Crane_1_350)));
Coeff_Attenuation_s1_400kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_400.*Isppa_Sans_1_400))/mean(nonzeros(FWHM_Crane_1_400.*Isppa_Crane_1_400)));
Coeff_Attenuation_s1_450kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_450.*Isppa_Sans_1_450))/mean(nonzeros(FWHM_Crane_1_450.*Isppa_Crane_1_450)));
Coeff_Attenuation_s1_500kHz = 10*log10(mean(nonzeros(FWHM_Sans_1_500.*Isppa_Sans_1_500))/mean(nonzeros(FWHM_Crane_1_500.*Isppa_Crane_1_500)));

Coeff_Attenuation_s2_250kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_250.*Isppa_Sans_2_250))/mean(nonzeros(FWHM_Crane_2_250.*Isppa_Crane_2_250)));
Coeff_Attenuation_s2_300kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_300.*Isppa_Sans_2_300))/mean(nonzeros(FWHM_Crane_2_300.*Isppa_Crane_2_300)));
Coeff_Attenuation_s2_350kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_350.*Isppa_Sans_2_350))/mean(nonzeros(FWHM_Crane_2_350.*Isppa_Crane_2_350)));
Coeff_Attenuation_s2_400kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_400.*Isppa_Sans_2_400))/mean(nonzeros(FWHM_Crane_2_400.*Isppa_Crane_2_400)));
Coeff_Attenuation_s2_450kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_450.*Isppa_Sans_2_450))/mean(nonzeros(FWHM_Crane_2_450.*Isppa_Crane_2_450)));
Coeff_Attenuation_s2_500kHz = 10*log10(mean(nonzeros(FWHM_Sans_2_500.*Isppa_Sans_2_500))/mean(nonzeros(FWHM_Crane_2_500.*Isppa_Crane_2_500)));

Coeff_Attenuation_s3_250kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_250.*Isppa_Sans_3_250))/mean(nonzeros(FWHM_Crane_3_250.*Isppa_Crane_3_250)));
Coeff_Attenuation_s3_300kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_300.*Isppa_Sans_3_300))/mean(nonzeros(FWHM_Crane_3_300.*Isppa_Crane_3_300)));
Coeff_Attenuation_s3_350kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_350.*Isppa_Sans_3_350))/mean(nonzeros(FWHM_Crane_3_350.*Isppa_Crane_3_350)));
Coeff_Attenuation_s3_400kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_400.*Isppa_Sans_3_400))/mean(nonzeros(FWHM_Crane_3_400.*Isppa_Crane_3_400)));
Coeff_Attenuation_s3_450kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_450.*Isppa_Sans_3_450))/mean(nonzeros(FWHM_Crane_3_450.*Isppa_Crane_3_450)));
Coeff_Attenuation_s3_500kHz = 10*log10(mean(nonzeros(FWHM_Sans_3_500.*Isppa_Sans_3_500))/mean(nonzeros(FWHM_Crane_3_500.*Isppa_Crane_3_500)));

Coeff_Attenuation_s4_250kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_250.*Isppa_Sans_4_250))/mean(nonzeros(FWHM_Crane_4_250.*Isppa_Crane_4_250)));
Coeff_Attenuation_s4_300kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_300.*Isppa_Sans_4_300))/mean(nonzeros(FWHM_Crane_4_300.*Isppa_Crane_4_300)));
Coeff_Attenuation_s4_350kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_350.*Isppa_Sans_4_350))/mean(nonzeros(FWHM_Crane_4_350.*Isppa_Crane_4_350)));
Coeff_Attenuation_s4_400kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_400.*Isppa_Sans_4_400))/mean(nonzeros(FWHM_Crane_4_400.*Isppa_Crane_4_400)));
Coeff_Attenuation_s4_450kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_450.*Isppa_Sans_4_450))/mean(nonzeros(FWHM_Crane_4_450.*Isppa_Crane_4_450)));
Coeff_Attenuation_s4_500kHz = 10*log10(mean(nonzeros(FWHM_Sans_4_500.*Isppa_Sans_4_500))/mean(nonzeros(FWHM_Crane_4_500.*Isppa_Crane_4_500)));

Coeff_Attenuation_s5_250kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_250.*Isppa_Sans_5_250))/mean(nonzeros(FWHM_Crane_5_250.*Isppa_Crane_5_250)));
Coeff_Attenuation_s5_300kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_300.*Isppa_Sans_5_300))/mean(nonzeros(FWHM_Crane_5_300.*Isppa_Crane_5_300)));
Coeff_Attenuation_s5_350kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_350.*Isppa_Sans_5_350))/mean(nonzeros(FWHM_Crane_5_350.*Isppa_Crane_5_350)));
Coeff_Attenuation_s5_400kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_400.*Isppa_Sans_5_400))/mean(nonzeros(FWHM_Crane_5_400.*Isppa_Crane_5_400)));
Coeff_Attenuation_s5_450kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_450.*Isppa_Sans_5_450))/mean(nonzeros(FWHM_Crane_5_450.*Isppa_Crane_5_450)));
Coeff_Attenuation_s5_500kHz = 10*log10(mean(nonzeros(FWHM_Sans_5_500.*Isppa_Sans_5_500))/mean(nonzeros(FWHM_Crane_5_500.*Isppa_Crane_5_500)));


%%
save('CoefficientsAttenuation_SessionAttenuation','Coeff_Attenuation_s1_250kHz','Coeff_Attenuation_s1_250kHz','Coeff_Attenuation_s1_300kHz','Coeff_Attenuation_s1_350kHz','Coeff_Attenuation_s1_400kHz','Coeff_Attenuation_s1_450kHz','Coeff_Attenuation_s1_500kHz',... 
    'Coeff_Attenuation_s2_250kHz','Coeff_Attenuation_s2_250kHz','Coeff_Attenuation_s2_300kHz','Coeff_Attenuation_s2_350kHz','Coeff_Attenuation_s2_400kHz','Coeff_Attenuation_s2_450kHz','Coeff_Attenuation_s2_500kHz',...
    'Coeff_Attenuation_s3_250kHz','Coeff_Attenuation_s3_250kHz','Coeff_Attenuation_s3_300kHz','Coeff_Attenuation_s3_350kHz','Coeff_Attenuation_s3_400kHz','Coeff_Attenuation_s3_450kHz','Coeff_Attenuation_s3_500kHz',... 
    'Coeff_Attenuation_s4_250kHz','Coeff_Attenuation_s4_250kHz','Coeff_Attenuation_s4_300kHz','Coeff_Attenuation_s4_350kHz','Coeff_Attenuation_s4_400kHz','Coeff_Attenuation_s4_450kHz','Coeff_Attenuation_s4_500kHz',... 
    'Coeff_Attenuation_s5_250kHz','Coeff_Attenuation_s5_250kHz','Coeff_Attenuation_s5_300kHz','Coeff_Attenuation_s5_350kHz','Coeff_Attenuation_s5_400kHz','Coeff_Attenuation_s5_450kHz','Coeff_Attenuation_s5_500kHz')


%%
Freq = [250:50:500];
Coeff_Attenuation_s1 = [Coeff_Attenuation_s1_250kHz, Coeff_Attenuation_s1_300kHz,Coeff_Attenuation_s1_350kHz,Coeff_Attenuation_s1_400kHz,Coeff_Attenuation_s1_450kHz,Coeff_Attenuation_s1_500kHz];
Coeff_Attenuation_s2 = [Coeff_Attenuation_s2_250kHz, Coeff_Attenuation_s2_300kHz,Coeff_Attenuation_s2_350kHz,Coeff_Attenuation_s2_400kHz,Coeff_Attenuation_s2_450kHz,Coeff_Attenuation_s2_500kHz];
Coeff_Attenuation_s3 = [Coeff_Attenuation_s3_250kHz, Coeff_Attenuation_s3_300kHz,Coeff_Attenuation_s3_350kHz,Coeff_Attenuation_s3_400kHz,Coeff_Attenuation_s3_450kHz,Coeff_Attenuation_s3_500kHz];
Coeff_Attenuation_s4 = [Coeff_Attenuation_s4_250kHz, Coeff_Attenuation_s4_300kHz,Coeff_Attenuation_s4_350kHz,Coeff_Attenuation_s4_400kHz,Coeff_Attenuation_s4_450kHz,Coeff_Attenuation_s4_500kHz];
Coeff_Attenuation_s5 = [Coeff_Attenuation_s5_250kHz, Coeff_Attenuation_s5_300kHz,Coeff_Attenuation_s5_350kHz,Coeff_Attenuation_s5_400kHz,Coeff_Attenuation_s5_450kHz,Coeff_Attenuation_s5_500kHz];

figure()
plot(Freq,Coeff_Attenuation_s1,'*-b')
hold on
plot(Freq,Coeff_Attenuation_s2,'*-g')
plot(Freq,Coeff_Attenuation_s3,'*-r')
plot(Freq,Coeff_Attenuation_s4,'*-k')
plot(Freq,Coeff_Attenuation_s5,'*-c')

title('Effect of the skull on the energy emitted by the transducer')
xlabel('Frequency (kHz]')
ylabel('Attenuation coefficient [dB]')
legend('session1','session2','session3','session4','session5')

%% 
Isppa_s1_Sans = [max(max(Isppa_Sans_1_250(:,1:91))),max(max(Isppa_Sans_1_300(:,1:91))),max(max(Isppa_Sans_1_350(:,1:91))),max(max(Isppa_Sans_1_400(:,1:91))),max(max(Isppa_Sans_1_450(:,1:91))),max(max(Isppa_Sans_1_500(:,1:91)))];
Isppa_s2_Sans = [max(max(Isppa_Sans_2_250(:,1:91))),max(max(Isppa_Sans_2_300(:,1:91))),max(max(Isppa_Sans_2_350(:,1:91))),max(max(Isppa_Sans_2_400(:,1:91))),max(max(Isppa_Sans_2_450(:,1:91))),max(max(Isppa_Sans_2_500(:,1:91)))];
Isppa_s3_Sans = [max(max(Isppa_Sans_3_250(:,1:91))),max(max(Isppa_Sans_3_300(:,1:91))),max(max(Isppa_Sans_3_350(:,1:91))),max(max(Isppa_Sans_3_400(:,1:91))),max(max(Isppa_Sans_3_450(:,1:91))),max(max(Isppa_Sans_3_500(:,1:91)))];
Isppa_s4_Sans = [max(max(Isppa_Sans_4_250(:,1:91))),max(max(Isppa_Sans_4_300(:,1:91))),max(max(Isppa_Sans_4_350(:,1:91))),max(max(Isppa_Sans_4_400(:,1:91))),max(max(Isppa_Sans_4_450(:,1:91))),max(max(Isppa_Sans_4_500(:,1:91)))];
Isppa_s5_Sans = [max(max(Isppa_Sans_5_250(:,1:91))),max(max(Isppa_Sans_5_300(:,1:91))),max(max(Isppa_Sans_5_350(:,1:91))),max(max(Isppa_Sans_5_400(:,1:91))),max(max(Isppa_Sans_5_450(:,1:91))),max(max(Isppa_Sans_5_500(:,1:91)))];

Isppa_s1_Avec = [max(max(Isppa_Crane_1_250(:,1:91))),max(max(Isppa_Crane_1_300(:,1:91))),max(max(Isppa_Crane_1_350(:,1:91))),max(max(Isppa_Crane_1_400(:,1:91))),max(max(Isppa_Crane_1_450(:,1:91))),max(max(Isppa_Crane_1_500(:,1:91)))];
Isppa_s2_Avec = [max(max(Isppa_Crane_2_250(:,1:91))),max(max(Isppa_Crane_2_300(:,1:91))),max(max(Isppa_Crane_2_350(:,1:91))),max(max(Isppa_Crane_2_400(:,1:91))),max(max(Isppa_Crane_2_450(:,1:91))),max(max(Isppa_Crane_2_500(:,1:91)))];
Isppa_s3_Avec = [max(max(Isppa_Crane_3_250(:,1:91))),max(max(Isppa_Crane_3_300(:,1:91))),max(max(Isppa_Crane_3_350(:,1:91))),max(max(Isppa_Crane_3_400(:,1:91))),max(max(Isppa_Crane_3_450(:,1:91))),max(max(Isppa_Crane_3_500(:,1:91)))];
Isppa_s4_Avec = [max(max(Isppa_Crane_4_250(:,1:91))),max(max(Isppa_Crane_4_300(:,1:91))),max(max(Isppa_Crane_4_350(:,1:91))),max(max(Isppa_Crane_4_400(:,1:91))),max(max(Isppa_Crane_4_450(:,1:91))),max(max(Isppa_Crane_4_500(:,1:91)))];
Isppa_s5_Avec = [max(max(Isppa_Crane_5_250(:,1:91))),max(max(Isppa_Crane_5_300(:,1:91))),max(max(Isppa_Crane_5_350(:,1:91))),max(max(Isppa_Crane_5_400(:,1:91))),max(max(Isppa_Crane_5_450(:,1:91))),max(max(Isppa_Crane_5_500(:,1:91)))];
%%
figure()
plot(Freq,Isppa_s1_Sans,'*-b')
hold on
plot(Freq,Isppa_s2_Sans,'*-g')
plot(Freq,Isppa_s3_Sans,'*-r')
plot(Freq,Isppa_s4_Sans,'*-k')
plot(Freq,Isppa_s5_Sans,'*-c')
title('Energy delivered into water without skull bone')
xlabel('Frequency (kHz]')
ylabel('Isppa [W/cm²]')
legend('session1','session2','session3','session4','session5')

figure()
plot(Freq,Isppa_s1_Avec,'*-b')
hold on
plot(Freq,Isppa_s2_Avec,'*-g')
plot(Freq,Isppa_s3_Avec,'*-r')
plot(Freq,Isppa_s4_Avec,'*-k')
plot(Freq,Isppa_s5_Avec,'*-c')
title('Energy delivered into water with skull bone')
xlabel('Frequency (kHz]')
ylabel('Isppa [W/cm²]')
legend('session1','session2','session3','session4','session5')


figure()
plot(Freq,Isppa_s1_Sans,'*-b')
hold on
plot(Freq,Isppa_s2_Sans,'*-g')
plot(Freq,Isppa_s3_Sans,'*-r')
plot(Freq,Isppa_s4_Sans,'*-k')
plot(Freq,Isppa_s5_Sans,'*-c')
plot(Freq,Isppa_s1_Avec,'*--b')
plot(Freq,Isppa_s2_Avec,'*--g')
plot(Freq,Isppa_s3_Avec,'*--r')
plot(Freq,Isppa_s4_Avec,'*--k')
plot(Freq,Isppa_s5_Avec,'*--c')
title('Energy delivered into water thanks to our stimulation prototype ')
xlabel('Frequency (kHz]')
ylabel('Isppa [W/cm²]')
legend('session1 without skull bone','session2 without skull bone','session3 without skull bone','session4 without skull bone','session5without skull bone','session1 with skull bone','session2 with skull bone','session3 with skull bone','session4 with skull bone','session5 with skull bone')

%%
Coeff_Attenuation_RatioMax_s1 = 10.*log10(Isppa_s1_Sans./Isppa_s1_Avec);
Coeff_Attenuation_RatioMax_s2 = 10.*log10(Isppa_s2_Sans./Isppa_s2_Avec);
Coeff_Attenuation_RatioMax_s3 = 10.*log10(Isppa_s3_Sans./Isppa_s3_Avec);
Coeff_Attenuation_RatioMax_s4 = 10.*log10(Isppa_s4_Sans./Isppa_s4_Avec);
Coeff_Attenuation_RatioMax_s5 = 10.*log10(Isppa_s5_Sans./Isppa_s5_Avec);

figure()
plot(Freq,Coeff_Attenuation_RatioMax_s1,'*-b')
hold on
plot(Freq,Coeff_Attenuation_RatioMax_s2,'*-g')
plot(Freq,Coeff_Attenuation_RatioMax_s3,'*-r')
plot(Freq,Coeff_Attenuation_RatioMax_s4,'*-k')
plot(Freq,Coeff_Attenuation_RatioMax_s5,'*-c')
plot(Freq,Coeff_Attenuation_s1,'*--b')
plot(Freq,Coeff_Attenuation_s2,'*--g')
plot(Freq,Coeff_Attenuation_s3,'*--r')
plot(Freq,Coeff_Attenuation_s4,'*--k')
plot(Freq,Coeff_Attenuation_s5,'*--c')
title('Attenuation coefficient for 5 sessions of measurements')
legend('Ratio Max Isppa s1','Ratio Max Isppa s2','Ratio Max Isppa s3','Ratio Max Isppa s4', 'Ratio Max Isppa s5','Ratio mean intensities into FWHM s1','Ratio mean intensities into FWHM s2','Ratio mean intensities into FWHM s3','Ratio mean intensities into FWHM s4','Ratio mean intensities into FWHM s5')
